
2021-04-28 23:12:42.819358: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Traceback (most recent call last):
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1367, in _do_call
    return fn(*args)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1352, in _run_fn
    target_list, run_metadata)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1445, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [512] rhs shape= [256]
	 [[{{node save_2/Assign_7}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/training/saver.py", line 1290, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 960, in run
    run_metadata_ptr)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1183, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1361, in _do_run
    run_metadata)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1386, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [512] rhs shape= [256]
	 [[node save_2/Assign_7 (defined at /home/elnouby/.local/lib/python3.6/site-packages/tflearn/helpers/trainer.py:161) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save_2/Assign_7:
 beta_7 (defined at classification.py:93)

Original stack trace for 'save_2/Assign_7':
  File "classification.py", line 140, in <module>
    checkpoint_path = './TrainingAutoEncoder/classification/AE/checkpoint')
  File "/home/elnouby/.local/lib/python3.6/site-packages/tflearn/models/dnn.py", line 65, in __init__
    best_val_accuracy=best_val_accuracy)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tflearn/helpers/trainer.py", line 161, in __init__
    allow_empty=True)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/training/saver.py", line 828, in __init__
    self.build()
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/training/saver.py", line 840, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/training/saver.py", line 878, in _build
    build_restore=build_restore)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/training/saving/saveable_object_util.py", line 74, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/gen_state_ops.py", line 59, in assign
    use_locking=use_locking, name=name)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/framework/op_def_library.py", line 742, in _apply_op_helper
    attrs=attr_protos, op_def=op_def)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py", line 3322, in _create_op_internal
    op_def=op_def)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py", line 1756, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "classification.py", line 153, in <module>
    model.load("./TrainingAutoEncoder/autoencoder/model.tfl",weights_only=True)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tflearn/models/dnn.py", line 302, in load
    self.trainer.restore(model_file, weights_only, **optargs)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tflearn/helpers/trainer.py", line 502, in restore
    self.restorer_trainvars.restore(self.session, model_file)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/training/saver.py", line 1326, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [512] rhs shape= [256]
	 [[node save_2/Assign_7 (defined at /home/elnouby/.local/lib/python3.6/site-packages/tflearn/helpers/trainer.py:161) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save_2/Assign_7:
 beta_7 (defined at classification.py:93)

Original stack trace for 'save_2/Assign_7':
  File "classification.py", line 140, in <module>
    checkpoint_path = './TrainingAutoEncoder/classification/AE/checkpoint')
  File "/home/elnouby/.local/lib/python3.6/site-packages/tflearn/models/dnn.py", line 65, in __init__
    best_val_accuracy=best_val_accuracy)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tflearn/helpers/trainer.py", line 161, in __init__
    allow_empty=True)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/training/saver.py", line 828, in __init__
    self.build()
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/training/saver.py", line 840, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/training/saver.py", line 878, in _build
    build_restore=build_restore)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/training/saving/saveable_object_util.py", line 74, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/gen_state_ops.py", line 59, in assign
    use_locking=use_locking, name=name)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/framework/op_def_library.py", line 742, in _apply_op_helper
    attrs=attr_protos, op_def=op_def)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py", line 3322, in _create_op_internal
    op_def=op_def)
  File "/home/elnouby/.local/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py", line 1756, in __init__
    self._traceback = tf_stack.extract_stack()

